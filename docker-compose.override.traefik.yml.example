# docker-compose.override.traefik.yml.example
#
# Este archivo muestra cómo integrar Portainer con Traefik del repositorio groales/traefik.
# Para usarlo:
#   1. Copia este archivo a docker-compose.override.yml
#   2. Ajusta el dominio (portainer.tudominio.com)
#   3. Asegúrate de que la red 'proxy' existe (creada por Traefik)
#
# Docker Compose automáticamente fusiona docker-compose.yml + docker-compose.override.yml

services:
  portainer:
    networks:
      - proxy
    labels:
      # Habilitar Traefik
      - "traefik.enable=true"
      
      # Router HTTPS
      - "traefik.http.routers.portainer.rule=Host(`portainer.tudominio.com`)"
      - "traefik.http.routers.portainer.entrypoints=websecure"
      - "traefik.http.routers.portainer.tls=true"
      - "traefik.http.routers.portainer.tls.certresolver=letsencrypt"
      
      # Service backend
      - "traefik.http.services.portainer.loadbalancer.server.port=9443"
      - "traefik.http.services.portainer.loadbalancer.server.scheme=https"
      - "traefik.http.services.portainer.loadbalancer.serversTransport=insecure@file"
      
      # Middlewares de seguridad (opcional)
      - "traefik.http.routers.portainer.middlewares=security-headers@file"

networks:
  proxy:
    external: true
